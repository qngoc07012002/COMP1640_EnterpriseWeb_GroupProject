@model ViewVM
@{
    ViewData["Title"] = "Article Management";
    int itemsPerPage = 6;
    int totalItems = Model.Articles.Count();
    int totalPages = (int)Math.Ceiling((double)totalItems / itemsPerPage);
    int currentPage = Context.Request.Query["page"].Count > 0 ? Convert.ToInt32(Context.Request.Query["page"]) : 1;
    int startIndex = (currentPage - 1) * itemsPerPage;
}



<link rel="stylesheet" href="~/css/Student/ViewArticle.css" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

<div>
    @if (ViewBag.MagazineName != null)
    {
        <h2>Magazine: @ViewBag.MagazineName</h2>
    }
    @if (ViewBag.TermName != null)
    {
        <h2>Term: @ViewBag.TermName</h2>
    }
    @if (ViewBag.FacultyName != null)
    {
        <h2>Faculty: @ViewBag.FacultyName</h2>
    }
</div>
<div class="main-container">
    <div class="content">
        <div class="card-container" id="cardContainer">
            @foreach (var article in Model.Articles.Skip(startIndex).Take(itemsPerPage))
            {
                <div class="card-1">
                    <div class="card-image-1">
                        <img src="@article.imgUrl" alt="image" />
                    </div>
                    <div class="card-text-1">
                        <a asp-area="Student" asp-controller="Article" asp-action="SelectArticle" asp-route-id="@article.ArticleId"><h3 >@article.Title</h3></a>
                        <p>@article.SubTitle</p>
                        <p style="color: #00BFFF"> Magazine @article.Magazines.Title</p>
                    </div>
                </div>
            }
        </div>
    </div>
    <div class="sidebar">
        <div class="search-container">
            <input type="text" placeholder="Search...">
            <button type="submit"><i class="fas fa-search"></i></button>
        </div>

        <label for="standard-select">Standard Select</label>
        <div class="custom-select">
            <select id="standard-select">
                <option value="Option 1">Option 1</option>
                <option value="Option 2">Option 2</option>
                <option value="Option 3">Option 3</option>
                <option value="Option 4">Option 4</option>
                <option value="Option 5">Option 5</option>
                <option value="Option length">Option that has too long of a value to fit</option>
            </select>
            <span class="custom-arrow"></span>
        </div>
        <div class="custom-select">
            <select id="standard-select">
                <option value="Option 1">Option 1</option>
                <option value="Option 2">Option 2</option>
                <option value="Option 3">Option 3</option>
                <option value="Option 4">Option 4</option>
                <option value="Option 5">Option 5</option>
                <option value="Option length">Option that has too long of a value to fit</option>
            </select>
            <span class="custom-arrow"></span>
        </div>
        <div class="custom-select">
            <select id="standard-select">
                <option value="Option 1">Option 1</option>
                <option value="Option 2">Option 2</option>
                <option value="Option 3">Option 3</option>
                <option value="Option 4">Option 4</option>
                <option value="Option 5">Option 5</option>
                <option value="Option length">Option that has too long of a value to fit</option>
            </select>
            <span class="custom-arrow"></span>
        </div>
    </div>
</div>

<ul class="pagination home-product-pagination text-center" id="pagination">
    @if (currentPage > 1)
    {
        <li class="pagination-item pagination-previous">
            <a href="#" class="pagination-item-link" data-page="@(currentPage - 1)">Previous</a>
        </li>
    }
    @for (int i = 1; i <= totalPages; i++)
    {
        <li class="pagination-item @(i == currentPage ? "pagination-item--active" : "")">
            <a href="#" class="pagination-item-link" data-page="@i">@i</a>
        </li>
    }
    @if (currentPage < totalPages)
    {
        <li class="pagination-item pagination-next">
            <a href="#" class="pagination-item-link" data-page="@(currentPage + 1)">Next</a>
        </li>
    }
</ul>


<script>
    document.addEventListener("DOMContentLoaded", function () {
        var maxTitleWords = 15; // Số từ tối đa cho Title
        var maxSubtitleWords = 20; // Số từ tối đa cho SubTitle

        limitWords('.card-text-1 h3', maxTitleWords);
        limitWords('.card-text-1 p', maxSubtitleWords);

        function limitWords(selector, maxWords) {
            var elements = document.querySelectorAll(selector);
            elements.forEach(function (element) {
                var words = element.textContent.trim().split(/\s+/);
                if (words.length > maxWords) {
                    element.textContent = words.slice(0, maxWords).join(" ") + '...';
                }
            });
        }
    });


        document.addEventListener("DOMContentLoaded", function () {
        const pagination = document.getElementById("pagination");
        pagination.addEventListener("click", function (event) {
            event.preventDefault();
            const target = event.target;
            if (target.classList.contains("pagination-item-link")) {
                const page = target.getAttribute("data-page");
                let url;
                const currentUrl = new URL(window.location.href);
                const magazineId = currentUrl.searchParams.get("magazineid");
                const termId = currentUrl.searchParams.get("termid");
                const facultyId = currentUrl.searchParams.get("facultyid");
                if (magazineId) {
                    url = `${window.location.pathname}?magazineid=${magazineId}&page=${page}`;
                    if (termId) {
                        url += `&termid=${termId}`;
                    }
                    if (facultyId) {
                        url += `&facultyid=${facultyId}`;
                    }
                } else if (termId) {
                    url = `${window.location.pathname}?termid=${termId}&page=${page}`;
                    if (facultyId) {
                        url += `&facultyid=${facultyId}`;
                    }
                } else if (facultyId) {
                    url = `${window.location.pathname}?facultyid=${facultyId}&page=${page}`;
                } else {
                    url = `${window.location.pathname}?page=${page}`;
                }
                window.location.href = url;
            }
        });
    });




 

</script>







